# puppet_inventory_scripts
Внешние скрипты для работы с БД инвентаризации для Linux ОС  
*проверено только на Centos5,6,7,8, ubuntu18, debian 9,10,11,12*  

Сделано сразу в одном репозитории и код самих скриптов и puppet-обвязка для их пуша,
т.к. без распространения этих скриптов, смысла в них мало.  

требует redhat-lsb-core, smartmontools  

именование линукс машин по следующему соглашению
hostname -f должен возвращать fqdn хоста  
это решается этим модулем:  
https://github.com/spo0okie/puppet_centos_hostname/

### History
 * 0.7.5nix: + xen сетевые интерфейсы добавлены в исключения
 * 0.7.4nix: + docker сетевые интерфейсы добавлены в исключения
 * 0.7.3nix: ! не учитывался флаг virtual при отправке данных в инвентори (большая часть оборудования не сканировалось, но не простоавлялся флажок в самой инвентори)
 * 0.7.2nix: добавлены разные варианты определения cpu вместо одного универсально. сначала пробум nproc, потом lscpu, потом dmidecode
 * 0.7.1nix: добавлена поддержка RHEL5 (curl без urlencode, отсутствуие nproc)
 * 0.7nix: убран предварительный поиск домена в БД, заменено на отправку FQDN имени
 * 0.6.6nix: поправлен wget запрос на чтение к API (--no-check-certificate) для систем без установленных/обновленных CA
 * 0.6.5nix: убрана опция -iec из вызова ip, т.к. она не поддерживается на старых версиях, и этот функционал не нужен для определения MAC и IP
 * 0.6.4nix: добавлен сбор дисков через lshw если lsblk не обнаружен
 * 0.6.3nix: поправлен учет дисков (фильтр блочных устров только типа disk)
 * 0.6.2nix: поправлен подсчет ядер
 * 0.6nix: учет MAC адресов
 * 0.5.1nix: ядра процессора отдаются отдельным параметром в JSON
 * 0.5nix: добавлена опция virtual. Если ее передать явно, то скрипт не пытается подробно сканировать оборудование, а просто возвращает количественные объемы ресурсов.
 * 0.4nix: первая продуктивная версия - работает и создает ОС
